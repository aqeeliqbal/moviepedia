This branch uses refactored code for Typescript

